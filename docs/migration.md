# データベースマイグレーションについて

## マイグレーションとは
データベースマイグレーションは、データベースの構造(スキーマ)を段階的に更新・管理する手法です。

### 主な目的
1. データベース構造の変更履歴を管理
2. チーム開発での整合性確保
3. 本番環境への安全なデプロイ

## Alembicによるマイグレーション管理

### 基本的な仕組み
1. マイグレーションスクリプトの生成
   - テーブルの作成・変更・削除などの操作をPythonコードとして記録
   - 各スクリプトには一意のバージョン番号が付与

2. マイグレーションの実行
   - upgrade(): 新しいバージョンへの更新
   - downgrade(): 以前のバージョンへの巻き戻し

### 主要コマンド
```bash
# マイグレーションスクリプトの生成
alembic revision --autogenerate -m "変更の説明"

# マイグレーションの実行(最新バージョンまで)
alembic upgrade head

# 特定のバージョンまで巻き戻し
alembic downgrade バージョン番号
```

### メリット
1. データベース構造の変更を安全に管理
2. チーム間での変更の共有が容易
3. 本番環境とテスト環境の整合性確保
4. 問題発生時の巻き戻しが可能

## 本プロジェクトでの利用方法

1. モデルの変更
   - SQLAlchemyのモデルクラスを修正

2. マイグレーションスクリプトの生成
   ```bash
   alembic revision --autogenerate -m "変更内容の説明"
   ```

3. マイグレーションの実行
   ```bash
   alembic upgrade head
   ```

4. 変更の確認
   - マイグレーション後のデータベース構造を確認
   - 必要に応じてテストデータの投入
